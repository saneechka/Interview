### Что такое defer?

Ключевое слово `defer` позволяет отложить выполнение функции до конца текущей функции. Это полезно для выполнения операций очистки, таких как закрытие файлов или освобождение ресурсов, независимо от того, как функция завершилась (нормально или с ошибкой).

Если в функции несколько отложенных вызовов, они будут выполнены в обратном порядке их объявления (стековый порядок).

### Что и почему напечатает программа?

```go
func f1() int {
    x := 1
    defer func() {
        x += 1
    }()
    return x
}
```

```go
func f2() (x int) {
    x = 1
    defer func() {
        x += 1
    }()
    return x
}
```

В функции `f1` переменная `x` является локальной. defer изменяет `x` после того, как выполняется `return x`. Однако, поскольку `x` является локальной переменной и не участвует в процессе возврата, возвращаемое значение равно значению `x` на момент выполнения `return`. Функция `f1` возвращает `1`.

В `f2` функции переменная `x` является именованной возвращаемой переменной. defer изменяет `x` после того, как выполняется `return`, но до того, как функция фактически вернет значение. Это происходит потому, что именованная возвращаемая переменная `x` участвует в процессе возврата. Функция `f2` возвращает `2`.
